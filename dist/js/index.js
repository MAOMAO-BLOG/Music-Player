console.log(window.player),console.log(window.Zepto),function(e,i){function t(t){this.wrap=t,this.dataList=[],this.indexObj=null,this.timer=null,this.list={},this.currIndex=0,this.progress=i.progress.pro()}t.prototype={init(){this.getDom(),this.getData("../mock/data.json")},getDom(){this.record=document.querySelector(".songImg img"),this.controlBtns=document.querySelectorAll(".control li")},getData(t){let s=this;e.ajax({url:t,method:"get",success:function(t){s.dataList=t,s.controlList(),s.indexObj=new i.controlIndex(t.length),s.loadMusic(s.indexObj.index),s.musicControl(),s.dragProgress()},error:function(){console.log("数据请求失败")}})},loadMusic(t){i.render(this.dataList[t]),i.music.load(this.dataList[t].audioSrc),this.progress.renderAllTime(this.dataList[t].duration),this.currIndex=t,this.list.select(t),"play"==i.music.status&&(i.music.play(),this.progress.move(0),this.controlBtns[2].className="playing",this.imgRotate(0)),i.music.end(()=>{this.loadMusic(this.indexObj.next())})},musicControl(){let s=this;this.controlBtns[1].addEventListener("touchend",function(){i.music.status="play",s.loadMusic(s.indexObj.prev())}),this.controlBtns[2].addEventListener("touchend",function(){var t;"play"==i.music.status?(i.music.pause(),this.className="",s.stopRotate(),s.progress.stop()):(i.music.play(),this.className="playing",t=s.record.dataset.rotate||0,s.imgRotate(t),s.progress.move())}),this.controlBtns[3].addEventListener("touchend",function(){i.music.status="play",s.loadMusic(s.indexObj.next())})},imgRotate(t){clearInterval(this.timer),this.timer=setInterval(()=>{t=+t+.2,this.record.style.transform="rotate("+t+"deg)",this.record.dataset.rotate=t},1e3/60)},stopRotate(){clearInterval(this.timer),this.timer=null},controlList(){let e=this;this.list=i.listControl(this.dataList,this.wrap),this.controlBtns[4].addEventListener("touchend",()=>{this.list.slideUp()}),this.list.musicList.forEach((t,s)=>{t.addEventListener("touchend",()=>{this.currIndex!=s&&(i.music.status="play",e.indexObj.index=s,e.loadMusic(s),e.list.slideDown())})})},dragProgress(){let e=this,t=i.progress.drag(document.querySelector(".circle"));t.init(),t.start=function(){e.progress.stop(),console.log("start")},t.move=function(t){e.progress.update(t)},t.end=function(t){var s=t*e.dataList[e.indexObj.index].duration;i.music.moveTo(s),i.music.play(),e.progress.move(t);t=e.record.dataset.rotate||0;e.imgRotate(t),e.controlBtns[2].className="playing"}}};let s=new t(document.querySelector("#wrap"));s.init()}(window.Zepto,window.player);